<div class="board-view-container" *ngIf="board && theme" 
     [style.background-color]="theme.backgroundColor"
     [style.color]="theme.textColor"
     [style.font-family]="theme.fontFamily">
  
  <div class="board-header no-print">
    <div class="container">
      <button class="btn btn-back" (click)="goBack()">← Back</button>
      <div class="board-actions">
        <button class="btn btn-primary" (click)="openMessageModal()">➕ Add Message</button>
        <button class="btn btn-secondary" (click)="editBoard()">✏️ Edit Board</button>
        <button class="btn btn-info" (click)="copyShareLink()">📋 Copy Link</button>
        <button class="btn btn-success" (click)="downloadBoard()">⬇️ Download</button>
        <button class="btn btn-print" (click)="printBoard()">🖨️ Print</button>
      </div>
    </div>
  </div>

  <div class="board-content">
    <div class="container">
      <div class="board-title" [style.color]="theme.primaryColor">
        <h1>{{ board.title }}</h1>
        <p class="occasion-badge" [style.background-color]="theme.primaryColor">
          {{ board.occasion }}
        </p>
      </div>

      <div class="board-info">
        <p><strong>For:</strong> {{ board.recipientName }}</p>
        <p><strong>Created by:</strong> {{ board.createdBy }}</p>
        <p>{{ board.description }}</p>
      </div>

      <div class="messages-section">
        <h2 [style.color]="theme.secondaryColor">Messages ({{ board.messages.length }})</h2>
        
        <div class="messages-grid" *ngIf="board.messages.length > 0">
          <div class="message-card" 
               *ngFor="let message of board.messages"
               [style.border-color]="theme.primaryColor">
            <div class="message-header">
              <strong [style.color]="theme.primaryColor">{{ message.authorName }}</strong>
              <div class="message-actions no-print">
                <button class="btn-icon" (click)="deleteMessage(message.id)" title="Delete">🗑️</button>
              </div>
            </div>
            
            <div class="message-media" *ngIf="message.mediaUrl">
              <img *ngIf="message.mediaType === 'image'" 
                   [src]="message.mediaUrl" 
                   alt="Message image"
                   class="message-image" />
              <video *ngIf="message.mediaType === 'video'" 
                     [src]="message.mediaUrl" 
                     controls
                     class="message-video"></video>
            </div>
            
            <div class="message-content">
              <p>{{ message.content }}</p>
            </div>
            
            <div class="message-time">
              {{ message.createdAt | date:'short' }}
            </div>
          </div>
        </div>

        <div class="empty-state" *ngIf="board.messages.length === 0">
          <div class="empty-icon">💬</div>
          <h3>No messages yet</h3>
          <p>Be the first to add a message to this board!</p>
          <button class="btn btn-primary" (click)="openMessageModal()">Add First Message</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Message Modal -->
  <div class="modal-overlay no-print" *ngIf="showMessageModal" (click)="closeMessageModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>Add a Message</h2>
        <button class="btn-close" (click)="closeMessageModal()">✕</button>
      </div>
      <app-message-create 
        [boardId]="board.id" 
        (messageAdded)="onMessageAdded()">
      </app-message-create>
    </div>
  </div>
</div>

<div class="not-found" *ngIf="!board">
  <div class="container">
    <h1>Board Not Found</h1>
    <p>The board you're looking for doesn't exist or has been deleted.</p>
    <button class="btn btn-primary" (click)="goBack()">Go Back Home</button>
  </div>
</div>
